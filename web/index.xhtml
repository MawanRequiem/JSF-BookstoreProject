<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" href="#{facesContext.externalContext.requestContextPath}/css/style.css"/>
        <link rel="preconnect" href="https://fonts.googleapis.com"/>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
         <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&amp;display=swap" rel="stylesheet"/>
        <link rel="stylesheet" href="#{facesContext.externalContext.requestContextPath}/css/index.css"/>
        <title>Tere Liye Bookstore</title>
    </h:head>

    <h:body>
        <ui:include src="header.xhtml" />
            <!-- Slideshow container -->
            <div class="slider">
                <div class="slides">
                    <input type="radio" name="radio-btn" id="radio1" checked="checked"/>
                    <input type="radio" name="radio-btn" id="radio2"/>
                    <input type="radio" name="radio-btn" id="radio3"/>

                    <div class="slide first">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/BEST OF TERE LIYE1.png" alt="Slide 1"/>
                    </div>

                    <div class="slide">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/BEST OF TERE LIYE 2.png" alt="Slide 2"/>
                    </div>

                    <div class="slide">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/BEST OF TERE LIYE 3.png" alt="Slide 3"/>
                    </div>

                    <div class="navigation-auto">
                        <div class="auto-btn1"></div>
                        <div class="auto-btn2"></div>
                        <div class="auto-btn3"></div>
                    </div>
                </div>

                <div class="navigation-manual">
                    <label for="radio1" class="manual-btn"></label>
                    <label for="radio2" class="manual-btn"></label>
                    <label for="radio3" class="manual-btn"></label>
                </div>
            </div>

            <!-- Section genre-icon -->
            <section class="genre-icon">
                <a href="aksiSeries.xhtml">
                    <div class="icons">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/Serial Aksi/pulang.jpeg" alt="Book Icon"/>
                        <div>
                            <h3>Serial Aksi</h3>
                        </div>
                    </div>
                </a>
                <a href="duniaParalelSeries.xhtml">
                    <div class="icons">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/dunia paralel/bumi.jpg" alt="Book Icon"/>
                        <div>
                            <h3>Serial Dunia Paralel</h3>
                        </div>
                    </div>
                </a>
                <a href="anakSeries.xhtml">
                    <div class="icons">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/serial anak/anak spesial.jpeg" alt="Book Icon"/>
                        <div>
                            <h3>Serial Anak Nusantara</h3>
                        </div>
                    </div>
                </a>
                <a href="gogonSeries.xhtml">
                    <div class="icons">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/gogons/1.jpg" alt="Book Icon"/>
                        <div>
                            <h3>Serial The Gogons</h3>
                        </div>
                    </div>
                </a>
                <a href="nonSeries.xhtml">
                    <div class="icons">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/non seri/teruslahbodoh.jpg" alt="Book Icon"/>
                        <div>
                            <h3>Novel non-serial</h3>
                        </div>
                    </div>
                </a>
                <a href="cerpen.xhtml">
                    <div class="icons">
                        <img src="#{facesContext.externalContext.requestContextPath}/image/cerpen/berjutarasa.jpg" alt="Book Icon"/>
                        <div>
                            <h3>Kumpulan Cerpen</h3>
                        </div>
                    </div>
                </a>
            </section>

            <!-- Best Seller Section -->
<h:form id="bookForm">

            <!-- Section Best Seller -->
            <div styleClass="carousel-main-div1" id="carousel1">
                <h:form>
                    <div class="carousel-main-div1" id="carousel1">
                        <p:carousel value="#{bukuBean.bukuList}" var="buku" numVisible="8" circular="true" autoplayInterval="3000" styleClass="carousel-main">
                            <p:panel styleClass="card-new">
                                <!-- Display book image -->
                                <h:graphicImage value="data:image/jpeg;base64,#{bukuBean.convertToBase64(buku.gambarBuku)}"
                                                alt="#{buku.namaBuku}" style="width: 100%; height: 200px; object-fit: cover;" />
                                <h3>#{buku.namaBuku}</h3>
                                <p>Genre: #{buku.genreBuku}</p>
                                <p>Stock: #{buku.stockBuku} item</p>
                                <h4>Price: Rp #{buku.hargaBuku}</h4>

                                <!-- Updated commandLink to open jQuery UI modal -->
                               <p:commandLink value="View Details" 
                                  actionListener="#{bukuBean.loadBuku(buku.idBuku)}"
                                  oncomplete="initDialog();"/>
                            </p:panel>
                        </p:carousel>
                    </div>
                </h:form>
            </div>

            <!-- jQuery UI Modal -->
            <div id="bookModal" title="Book Details" style="display:none;">
                <h3 id="modalBookTitle"></h3>
                <p><strong>Genre:</strong> <span id="modalBookGenre"></span></p>
                <p><strong>Series:</strong> <span id="modalBookSeries"></span></p>
                <p><strong>Price:</strong> Rp <span id="modalBookPrice"></span></p>
                <p><strong>Stock:</strong> <span id="modalBookStock"></span> items</p>
                <p><strong>Description:</strong> <span id="modalBookDescription"></span></p>
                <img id="modalBookImage" style="width:100%;height:200px;object-fit:cover;" alt="Book Image" />
            </div>
        </h:form>

            <script type="text/javascript" src=""></script>
    <script type="text/javascript">
            // Initialize the modal using jQuery UI
            function initDialog() {
                // Updating modal content
                var title = '#{bukuBean.selectedBook.namaBuku}';
                var genre = '#{bukuBean.selectedBook.genreBuku}';
                var series = '#{bukuBean.selectedBook.seriesBuku}';
                var price = '#{bukuBean.selectedBook.hargaBuku}';
                var stock = '#{bukuBean.selectedBook.stockBuku}';
                var description = '#{bukuBean.selectedBook.deskripsiBuku}';
                var imageBase64 = '#{bukuBean.convertToBase64(bukuBean.selectedBook.gambarBuku)}';

                // Update modal content with JSF-managed bean data
                $("#modalBookTitle").text(title);
                $("#modalBookGenre").text(genre);
                $("#modalBookSeries").text(series);
                $("#modalBookPrice").text(price);
                $("#modalBookStock").text(stock);
                $("#modalBookDescription").text(description);
                $("#modalBookImage").attr("src", "data:image/jpeg;base64," + imageBase64);

                // Show modal
                $("#bookModal").dialog({
                    modal: true,
                    width: 600,
                    buttons: {
                        "Add to Cart": function () {
                            // You can add your JSF addToCart action here
                            // Example: #{cartBean.addToCart(bukuBean.selectedBook)}
                            $(this).dialog("close");
                        },
                        Close: function () {
                            $(this).dialog("close");
                        }
                    }
                });
            }
        </script>

        <ui:include src="footer.xhtml" />
    </h:body>
</html>
